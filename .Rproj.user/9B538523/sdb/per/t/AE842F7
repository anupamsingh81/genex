{
    "collab_server" : "",
    "contents" : "\nspecimen = c(rep(\"BAL\",357),rep(\"Sputum\",83),rep(\"Pleural\",167),rep(\"Others\",179))\n\nculture = c(rep(\"positive\",39),rep(\"negative\",318),rep(\"positive\",18),rep(\"negative\",65),\n            rep(\"positive\",5),rep(\"negative\",162),\n            rep(\"positive\",15),rep(\"negative\",164)\n            \n            )\n\n\nsmear = c( rep(\"positive\",18),rep(\"negative\",21),\n           rep(\"positive\",2),rep(\"negative\",316),\n           rep(\"positive\",9),rep(\"negative\",9),\n           \n           rep(\"positive\",2),rep(\"negative\",63),\n           rep(\"positive\",1),rep(\"negative\",4),\n           rep(\"negative\",162),\n           rep(\"positive\",2),rep(\"negative\",13),\n           rep(\"positive\",2),rep(\"negative\",162)\n           \n           )\n\nxpert = c(rep(\"positive\",18),rep(\"negative\",0),\n          rep(\"positive\",18),rep(\"negative\",3),\n          rep(\"positive\",2),rep(\"negative\",0),\n          rep(\"positive\",20),rep(\"negative\",296),\n          rep(\"positive\",9),rep(\"negative\",0),\n          rep(\"positive\",7),rep(\"negative\",2),\n          rep(\"positive\",1),rep(\"negative\",1),\n          rep(\"positive\",1),rep(\"negative\",62),\n          rep(\"positive\",1),rep(\"negative\",0),\n          rep(\"positive\",2),rep(\"negative\",2),\n          rep(\"positive\",0),rep(\"negative\",0),\n          rep(\"positive\",3),rep(\"negative\",159),\n          rep(\"positive\",2),rep(\"negative\",0),\n          \n          rep(\"positive\",11),rep(\"negative\",2),\n          rep(\"positive\",2),rep(\"negative\",0),\n          rep(\"positive\",19),rep(\"negative\",143))\n        \n\n\nsmear = ifelse(smear==\"negative\",0,1)\nxpert = ifelse(xpert==\"negative\",0,1)\n\n\n\n  \n   lev = c(\"negative\",\"positive\")   \n   \n   culture = as.factor(culture)\n   smear = as.factor(smear)\n   xpert = as.factor(xpert)\n   \n  ? as.factor\n   \n   dat = data.frame(specimen,culture,smear,xpert)\n   \n   \n   dat$smear[dat$smear==\"negative\"]<- 0\n   dat$smear[dat$smear==\"positive\"]<- 1\n   \n   \n   library(pROC)\n   \n   \n   # Overall ROC Curves\n   \n  smear_roc = roc(dat$culture,dat$smear ,data=dat)\n   \n  xpert_roc = roc(dat$culture,dat$xpert ,data=dat)\n  \n  xpert_roc$specificities[2]\n  xpert_roc$sensitivities[2]\n  smear_roc$specificities[2]\n  smear_roc$sensitivities[2]\n  \n  \n  \n  \n  \n  roc.test(smear_roc,xpert_roc)\n  \n  \n  plot(smear_roc,col=\"red\")\n  plot(xpert_roc,add=TRUE,col=\"blue\")\n  \n  legend('bottomright', names(dat)[c(3:4)] , \n         lty=1, col=c('red', 'blue'),  cex=.75)\n  \n  \n  title(main =\" Comparison Of Area under Curves of gene-xpert and smear microscopy\",line = 3.0)\n  \n  \n  table(dat$smear,dat$culture)\n  \n  table(dat$xpert,dat$culture)\n  \n  \n  table(dat$smear,dat$xpert,dat$culture)\n  \n  \n  \n  # Net Benefit analysis overall\n  \n  library(rmda)\n  \n  dat$culture = ifelse(dat$culture==\"negative\",0,1)\n  \n  \n  smear.model <- decision_curve(culture~smear, \n                                   \n                                   data = dat,\n                                   study.design = \"cohort\",\n                                   policy = \"opt-in\", #default\n                                   bootstraps = 50)\n  \n \n  add_gene_xpert.model <- decision_curve(culture~smear+xpert, \n                                \n                                data = dat,\n                                study.design = \"cohort\",\n                                policy = \"opt-in\", #default\n                                bootstraps = 50)\n  \n   xpert.model <- decision_curve(culture~xpert, \n                                 \n                                 data = dat,\n                                 study.design = \"cohort\",\n                                 policy = \"opt-in\", #default\n                                 bootstraps = 50)\n   \n   \n   \n   plot_decision_curve( list(smear.model, add_gene_xpert.model),\n                        curve.names = c(\"smear microscopy\", \"smear and gene xpert\"), xlim =\n                          c(0, 1), legend.position = \"bottomright\")\n   \n   plot_decision_curve( list(smear.model, xpert.model),\n                        curve.names = c(\"smear microscopy\", \"gene xpert\"), xlim =\n                          c(0, 1), legend.position = \"bottomright\")\n   \n   ",
    "created" : 1506167775792.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3219399659",
    "id" : "AE842F7",
    "lastKnownWriteTime" : 1506178182,
    "last_content_update" : 1506178182352,
    "path" : "~/Documents/gene_xpert/gene_xpert.R",
    "project_path" : "gene_xpert.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}